# 🐱 猫仔ComfyUI伴侣 首次使用需求表

## 1. 基础环境
- 操作系统：Windows 10/11（64位）
- Python：3.8 及以上（建议 3.10+），需添加到 PATH
- 显卡与驱动：支持 GPU 的显卡（如 NVIDIA），已安装对应驱动
- 网络：可访问 ComfyUI 本地接口（默认 127.0.0.1:8187），若跨机器需放通端口

## 2. 软件/依赖
- ComfyUI：需先安装并能正常启动，默认端口 8187（可自定义）
- 本工具依赖：requests（tkinter 为内置库）
- 虚拟环境：推荐使用仓库自带的 .venv（通过安装脚本创建）

## 3. 文件结构（关键文件）
- 猫仔ComfyUI伴侣.py —— 主程序
- process_monitor.py —— 监控与捕获逻辑
- 启动-猫仔ComfyUI伴侣.bat —— 启动脚本
- 环境安装-猫仔ComfyUI伴侣.bat —— 环境安装脚本（新）
- saved_workflows/ —— 已保存的工作流配置
- 生成结果/ —— 默认输出目录

## 4. 首次使用步骤
1) 运行环境安装脚本（推荐）
   - 双击 `环境安装-猫仔ComfyUI伴侣.bat`
   - 自动检测/创建 `.venv`，安装依赖（requests），校验导入
   - 若未安装 Python，会给出下载提示

2) 启动 ComfyUI
   - 在本地先启动 ComfyUI，记住端口（默认 8187）

3) 启动本工具
   - 默认：双击 `启动-猫仔ComfyUI伴侣.bat`
   - 若想强制使用虚拟环境运行，可在 bat 中将 `python` 改为 `.venv\Scripts\python.exe`

4) 在工具中完成首次配置
   - 第零步：点击「探测可用端口」，确认端口（通常 8187）
   - 第一步：选择「开始监控」并在 ComfyUI 完成一次生图，或「加载配置」直接选择已保存的 workflow.json
   - 第二步：选择批量模式（批量生成、单图处理、文件夹批处理、双图融合、单图+文件夹融合、文件夹交叉融合）
   - 第三步：可选设置输出路径，默认 `生成结果`
   - 第四步：开始批量执行，完成后可「打开结果文件夹」

## 5. 常见问题与排查
- 未检测到 Python：安装 Python 3.8+，并勾选「Add python.exe to PATH」
- 依赖安装失败：检查网络或切换国内源；可重试执行安装脚本
- 提示无法连接 ComfyUI：确认 ComfyUI 已启动、端口正确，或检查防火墙
- 捕获不到工作流：需在监控期间完成一次完整生图；或直接加载已保存配置
- 融合模式校验失败：当前 workflow 需至少含 2 个 LoadImage 节点

## 6. 建议
- 首次使用务必运行安装脚本，确保依赖完整
- 工作流捕获后请及时保存（saved_workflows 目录），避免重复操作
- 为不同项目设置不同输出路径，便于管理结果
- 遇到问题先查看结果目录下的「执行日志.txt」
