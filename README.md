# 🐱 猫仔ComfyUI伴侣 V3 最终版本

## 📦 文件清单

本文件夹包含V3最终版本的所有必需文件：

### 核心文件
1. **猫仔ComfyUI伴侣.py** - 主程序文件
2. **process_monitor.py** - 流程监控核心模块
3. **启动-猫仔ComfyUI伴侣.bat** - Windows启动脚本
4. **README.md** - 本文件（使用说明）

---

## 🚀 快速开始

### 方法1：使用启动脚本（推荐）
双击运行 `启动-猫仔ComfyUI伴侣.bat`

### 方法2：使用Python直接运行
```bash
python 猫仔ComfyUI伴侣.py
```

---

## ✨ V3 版本新功能

### 1. 提示词预览 💬
- 自动提取并显示工作流中提示词的前30个字符
- 快速识别当前加载的工作流配置
- 在捕获或加载工作流时自动更新

### 2. 自定义输出路径 📁
- 可自定义生成结果的保存位置
- 支持通过界面选择或手动输入路径
- 默认保存到"生成结果"文件夹

详细功能说明请查看 `V3新增功能说明.md`

---

## 📋 使用流程

### 第零步：选择ComfyUI端口
1. 点击「探测可用端口」
2. 选择ComfyUI运行的端口（通常是8187）
3. 点击「确认端口」

### 第一步：获取工作流
**方式A - 监控捕获（首次使用）**
1. 点击「开始监控」
2. 在ComfyUI界面完成一次完整的生图操作
3. 点击「停止监控」
4. 系统会自动捕获工作流并显示提示词预览
5. 建议点击「保存配置」保存工作流以便下次使用

**方式B - 加载配置（已有配置文件）**
1. 点击「加载配置」
2. 选择之前保存的workflow.json文件
3. 系统会自动显示提示词预览

### 第二步：选择批量模式
- **批量生成**：重复执行当前workflow N次（每次随机种子不同，comfyui通用）
- **单图处理**：对指定图片进行N次处理
- **文件夹批处理**：批量处理文件夹中的所有图片
- **双图融合**：图片1和图片2融合生成
- **单图+文件夹融合**：一张图片与文件夹中每张图片融合
- **文件夹交叉融合**：文件夹1和文件夹2的图片交叉融合

### 第三步：设置输出路径（可选）
在"输出路径"输入框中：
- 直接输入自定义路径，或
- 点击「选择文件夹」通过图形界面选择
- 不设置则使用默认路径"生成结果"

### 第四步：开始批量执行
1. 点击「开始批量」
2. 等待执行完成
3. 点击「打开结果文件夹」查看生成的图片

---

## 🛠️ 系统要求

- **操作系统**：Windows 10/11
- **Python版本**：3.8+
- **依赖库**：
  - tkinter（Python自带）
  - requests
  - threading
  - json

- **外部依赖**：
  - ComfyUI（需要正在运行）

---

## 📊 支持的批量模式对比

| 模式 | 适用场景 | 输入要求 |
|-----|---------|--------|
| 批量生成 | 需要生成多张相似但不同的图片（comfyui通用） | 无需额外输入 |
| 单图处理 | 对同一张图片进行多次处理 | 1张图片 |
| 文件夹批处理 | 批量处理多张图片 | 1个文件夹 |
| 双图融合 | 图片1和图片2融合 | 2张图片 |
| 单图+文件夹融合 | 一张图片与多张图片分别融合 | 1张图片 + 1个文件夹 |
| 文件夹交叉融合 | 文件夹1和文件夹2的图片交叉融合 | 2个文件夹 |

---

## 📁 输出结果结构

```
[输出路径]/
  └── [模式名称]_[时间戳]/
      ├── ComfyUI_00001_.png     # 生成的图片
      ├── ComfyUI_00002_.png
      ├── ...
      ├── 使用的workflow.json    # 使用的工作流配置
      └── 执行日志.txt           # 详细执行日志
```

---

## ❓ 常见问题

**Q: 提示"无法连接到ComfyUI"？**
A: 确保ComfyUI正在运行，并且端口设置正确（通常是8187）。

**Q: 捕获工作流后没有显示提示词？**
A: 可能工作流中没有文本提示词节点，或者提示词字段名称不标准。

**Q: 生成的图片保存在哪里？**
A: 默认保存在"生成结果"文件夹，或你设置的自定义输出路径中。

**Q: 可以在执行过程中暂停吗？**
A: 可以！点击「暂停」按钮即可暂停，再次点击继续执行。

**Q: 批量生成模式会改变种子吗？**
A: 会！每次生成都会使用不同的随机种子，确保生成的图片有所不同。

---

## 📝 版本信息

**版本号**：V3.0  
**发布日期**：2026年1月19日  
**更新内容**：
- ✨ 新增提示词预览功能
- ✨ 新增自定义输出路径功能
- 🔧 优化了批量生成的随机种子机制
- 📚 完善了文档说明

---

---

## 💡 使用提示

1. **首次使用建议保存配置**：捕获工作流后，建议立即保存配置，避免重复捕获。
2. **检查提示词预览**：加载工作流后，查看提示词预览确认是否正确。
3. **合理设置输出路径**：为不同项目设置不同的输出路径，便于管理。
4. **查看执行日志**：如遇问题，查看生成结果文件夹中的"执行日志.txt"。
5. **备份重要配置**：将常用的workflow配置文件保存到安全位置。

---

## 📞 技术支持

如有问题或建议，请检查：
1. 执行日志文件
2. ComfyUI是否正常运行
3. Python环境是否正确配置

---

**祝您使用愉快！** 🎉
